<sequence name="PatientRegistrationProcessingSequence" xmlns="http://ws.apache.org/ns/synapse">
    <log level="custom">
        <property name="INFO" value="Checking for new patient registrations"/>
    </log>

    <!-- Assuming the payload is already set via JMS Proxy or another mediator -->
    <!-- Use a filter to check if payload contains registrationId -->
    <filter xpath="boolean(json-eval($.registrationId))">
        <then>
            <log level="custom">
                <property name="INFO" expression="fn:concat('Processing patient registration: ', json-eval('$.registrationId'))"/>
            </log>

            <!-- Your processing logic would go here -->

            <log level="custom">
                <property name="INFO" expression="fn:concat('Successfully processed registration ', json-eval('$.registrationId'))"/>
            </log>
        </then>
        <else>
            <log level="custom">
                <property name="DEBUG" value="No new registrations found or invalid message"/>
            </log>
        </else>
    </filter>
</sequence>
